@model Tiki_Web_Project.Models.HomeViewModel

@functions {
    public decimal RoundToNearest(decimal value, int multiple)
    {
        return Math.Round(value / multiple) * multiple;
    }
}

@{
    var product = Model.Products.First();
}

@{
    var discountValue = @product.Price * @product.Discount / 100;
    var finalPrice = @product.Price - discountValue;
     if (finalPrice > 10000 && @product.Discount >= 1)
        finalPrice = RoundToNearest(finalPrice, 1000);
    else if (finalPrice > 100000 && @product.Discount >= 1)
        finalPrice = RoundToNearest(finalPrice, 10000);
}



<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="~/css/Product/ProductPage.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <!-- Thêm link CSS hoặc script khác tại đây -->
</head>
<main>
    <div class="MainContainer">
        <div class="ShowProduct">
            <div class="ProductInfo" >
                <div class="LeftBody">
                        <div class="ProductWidget" style="display: flex; flex-direction: column; width: 400px; background: white; position: sticky; top: 12px; gap: 16px; padding: 16px 0px 12px;">
                            <div class="ProductImageStyle">
                                <div class="image-frame">
                                    <div data-view-id="pdp_main_view_gallery" id="mainImage" style="width: 368px; height: 368px;">
                                        <div style="position: relative; cursor: pointer;">
                                            <picture class="webpimg-container">
                                            <img src="@Url.Content("~/img/ProductImage/" + @product.SubID + "/"+ @product.ProductID + "/1.jpg")"
                                                 width="368" height="368"
                                                        loading="eager"
                                                        class="styles__StyledImg-sc-p9s3t3-0 hbqSye"
                                                        style="width: 368px; height: 368px; z-index: 2; opacity: 1;">
                                            </picture>
                                        </div>
                                    </div>
                                    <div class="image-badges"></div>
                                </div>
                                <div class="ThumbnailListStyle">
                                        <div class="ThumbnailSlider">
                                    <span class="icon-prev" id="prevbtn" style="visibility: hidden;"><svg width="20" height="20" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.0899 14.5899C11.7645 14.9153 11.2368 14.9153 10.9114 14.5899L5.91139 9.58991C5.58596 9.26447 5.58596 8.73683 5.91139 8.4114L10.9114 3.41139C11.2368 3.08596 11.7645 3.08596 12.0899 3.41139C12.4153 3.73683 12.4153 4.26447 12.0899 4.58991L7.67916 9.00065L12.0899 13.4114C12.4153 13.7368 12.4153 14.2645 12.0899 14.5899Z" fill="#0A68FF"></path></svg></span>
                                            <div class="content">
                                                <span class="slider" style="gap: 8px; transform: translateX(0px); transition: 0.5s ease-in-out;">
                                                    @foreach (var image in product.Images)
                                                    {
                                                        <a data-view-id="pdp_main_view_photo" class="ThumbnailItemStyle">
                                                            <picture class="webpimg-container">
                                                                <img width="47" height="47" alt="product-img"
                                                            src="@Url.Content("~/img/ProductImage/" +  product.SubCategory.CategoryID + "/" + product.SubID + "/" + product.ProductID + "/" + image.ImageUrl)"
                                                                     class="thumbnail" style="width: 47px;">
                                                            </picture>
                                                        </a>
                                                    }
                                                </span>
                                            </div>
                                            <span class="icon-next" id="nextbtn"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 18 18" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M5.91107 3.41107C6.23651 3.08563 6.76414 3.08563 7.08958 3.41107L12.0896 8.41107C12.415 8.73651 12.415 9.26415 12.0896 9.58958L7.08958 14.5896C6.76414 14.915 6.23651 14.915 5.91107 14.5896C5.58563 14.2641 5.58563 13.7365 5.91107 13.4111L10.3218 9.00033L5.91107 4.58958C5.58563 4.26414 5.58563 3.73651 5.91107 3.41107Z" fill="#0A68FF"></path></svg></span>
                                        </div>
                                </div>
                            </div>
                        </div>

                        <div class="StyledProductContent">
                            <div class="BodyContainerStyled">
                                <div class="ProductInfoWidget">
                                    <div class="BodyInfo">
                                        <div style="display: flex; flex-direction: column; gap: 6px;">
                                            <div class="HeaderStyled">
                                                <div class="BrandAuthor">
                                                    <picture class="webpimg-container">
                                                        <source type="image/webp" srcset="https://salt.tikicdn.com/ts/upload/be/67/48/04a82ab8df178e1a13bde38316081865.png">
                                                        <img src="https://salt.tikicdn.com/ts/upload/be/67/48/04a82ab8df178e1a13bde38316081865.png" width="91" height="20" alt="freeship_xtra">
                                                    </picture>
                                                    <picture class="webpimg-container">
                                                        <source type="image/webp" srcset="https://salt.tikicdn.com/ts/ta/b1/3f/4e/cc3d0a2dd751a7b06dd97d868d6afa56.png">
                                                        <img src="https://salt.tikicdn.com/ts/ta/b1/3f/4e/cc3d0a2dd751a7b06dd97d868d6afa56.png" width="114" height="20" alt="return_policy">
                                                    </picture>
                                                    <picture class="webpimg-container">
                                                        <source type="image/webp" srcset="https://salt.tikicdn.com/ts/upload/d7/56/04/b93b8c666e13f49971483596ef14800f.png">
                                                        <img src="https://salt.tikicdn.com/ts/upload/d7/56/04/b93b8c666e13f49971483596ef14800f.png" width="89" height="20" alt="is_authentic">
                                                    </picture>
                                                    <span class="brand-and-author no-after">
                                                        <h6>Thương hiệu: <a data-view-id="pdp_details_view_brand" href="/thuong-hieu/coffee-tree.html">COFFEE TREE</a></h6>
                                                    </span>
                                                </div>
                                                <h1 class="Title">
                                                     @product.Name
                                                </h1>
                                                <div class="Rating">
                                                    <div style="display: flex;">
                                                        <div class="StyledReview">
                                                            <div style="margin-right: 4px; font-size: 14px; line-height: 150%; font-weight: 500;">4.6</div>
                                                            <div style="display: flex;">
                                                                <div style="position: relative;">
                                                                    <div style="display: flex; align-items: center;">
                                                                        <!-- SVG stars go here -->
                                                                    </div>
                                                                    <div style="width: 92%; white-space: nowrap; position: absolute; left: 0; top: 0; overflow: hidden;">
                                                                        <!-- Colored SVG stars go here -->
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <a class="number" data-view-id="pdp_main_view_review">(269)</a>
                                                        </div>
                                                        <div data-view-id="pdp_quantity_sold" class="QuantitySold">Đã bán 1k</div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="StyledProductPrice">
                                                <div class="product-price">
                                                <div class="product-price__current-price" style="color: @(Model.Products[0].Discount == 0 ? "rgb(39, 39, 42)" : "red");"> @finalPrice.ToString("N0") <sup>₫</sup></div>
                                                <div class="product-price__discount-rate" style="@(Model.Products[0].Discount == 0 ? "visibility: hidden" : "visibility: visible");">-@product.Discount%</div>
                                                    <div class="product-price__discount-icon">
                                                        <img src="https://salt.tikicdn.com/ts/upload/59/3f/08/2635c54cb215de11383507b2fe38bde3.png" width="14" height="14" alt="discount-icon">
                                                    </div>
                                                <div class="product-price__original-price" style="@(Model.Products[0].Discount == 0 ? "visibility: hidden" : "visibility: visible");"> <del> @product.Price.ToString("N0") </del><sup>₫</sup></div>
                                                </div>
                                                <img src="https://salt.tikicdn.com/ts/upload/1c/d0/ac/e89ef64c4a607d248e9e524b69aa1d0c.png" width="75" height="22" alt="price_badge">
                                            </div>
                                            <div class="styles__CouponInfoStyled-sc-2uv4ce-1 fUpsQL">
                                                <div class="title">Giá sau áp dụng mã khuyến mãi</div>
                                                <div class="styles__HighlightInfoContentStyled-sc-2uv4ce-0 beAYJb">
                                                    <img src="https://salt.tikicdn.com/ts/upload/49/84/13/374bbea1f7a6a7dc16a17683cfb95ac2.png" alt="MP9OXS1PXD" width="18" height="18">
                                                    <div><strong>Giảm 8.000<sup>₫</sup></strong><span style="color:#808089;"> từ mã khuyến mãi của nhà bán</span></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="ProductInfoWidget">
                                    <div class="WidgetTitle">Thông tin chi tiết</div>
                                    <div style="display: flex; flex-direction: column;">
                                        @foreach (var attributes in Model.ProductAttributes) {
                                            <div class="WidgetContentStyled">
                                                <div class="WidgetContentRowStyled" style="display: grid; grid-template-columns: 55% 45%; gap: 4px;">
                                                    <span style="max-width: 300px; color: rgb(128, 128, 137);">@attributes.AttributeName</span>
                                                    <span class="ProductAttributeValueStyled">@attributes.AttributeValue</span>
                                                </div>
                                            </div>
                                        }
                                    </div>
                                </div>

                            </div>
                        </div>
                     </div>
                <div class="RightBody">
                    <div style="position: sticky; top: 12px; display: flex; flex-direction: column; align-items: stretch; gap: 12px;">
                        <div class="WidgetContainerStyled" style="gap: 16px; overflow: initial;">
                            <div class="SellerHeader" style="display: flex; gap: 0px; align-items: center; height: 65px;">
                                <div style="display: flex; gap: 8px; align-items: center; height: 65px;">
                                    <a href="/cua-hang/coffee-tree-official-store?source_screen=product_detail&amp;source_engine=organic">
                                        <picture class="webpimg-container">
                                            <source type="image/webp" srcset="https://vcdn.tikicdn.com/cache/w100/ts/seller/33/6d/3a/06586cb2416f3ad195441e16e8f0eff9.jpg.webp 1x, https://vcdn.tikicdn.com/cache/w100/ts/seller/33/6d/3a/06586cb2416f3ad195441e16e8f0eff9.jpg.webp 2x">
                                            <img srcset="https://vcdn.tikicdn.com/cache/w100/ts/seller/33/6d/3a/06586cb2416f3ad195441e16e8f0eff9.jpg 1x, https://vcdn.tikicdn.com/cache/w100/ts/seller/33/6d/3a/06586cb2416f3ad195441e16e8f0eff9.jpg 2x" class="styles__StyledImg-sc-p9s3t3-0 hbqSye logo" width="40" height="40" alt="Coffee Tree Official Store" style="border-radius: 50%; min-width: 40px; width: 40px; height: 40px; opacity: 1;">
                                        </picture>
                                    </a>
                                    <div style="display: flex; flex-direction: column; gap: 0px;">
                                        <span class="seller-name">
                                            <div class="SellerName">
                                                <a href="/cua-hang/coffee-tree-official-store?source_screen=product_detail&amp;source_engine=organic">
                                                    <span>Coffee Tree Official Store</span>
                                                </a>
                                            </div>
                                        </span>
                                        <div class="SellerDetailInfoStyled">
                                            <div class="item">
                                                <picture class="webpimg-container">
                                                    <source type="image/webp" srcset="https://salt.tikicdn.com/cache/w100/ts/upload/6b/25/fb/c288b5bcee51f35f2df0a5f5f03de2e1.png.webp 1x, https://salt.tikicdn.com/cache/w100/ts/upload/6b/25/fb/c288b5bcee51f35f2df0a5f5f03de2e1.png.webp 2x">
                                                    <img srcset="https://salt.tikicdn.com/cache/w100/ts/upload/6b/25/fb/c288b5bcee51f35f2df0a5f5f03de2e1.png 1x, https://salt.tikicdn.com/cache/w100/ts/upload/6b/25/fb/c288b5bcee51f35f2df0a5f5f03de2e1.png 2x" class="styles__StyledImg-sc-p9s3t3-0 hbqSye badge-img" alt="seller-badge" style="width: 72px; height: 20px; min-width: 72px; min-height: 20px; opacity: 1;">
                                                </picture>
                                            </div>
                                            <div class="item review">
                                                <div class="title">
                                                    <span>4.7</span>
                                                    <img alt="star-icon" src="https://salt.tikicdn.com/ts/upload/e3/f0/86/efd76e1d41c00ad8ebb7287c66b559fd.png" width="16" height="16">
                                                </div>
                                                <div class="sub-title">(2.5k+ đánh giá)</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="StyledButtonChat">
                                    <img alt="chat-icon" src="https://salt.tikicdn.com/ts/upload/8b/82/74/cf2c041938ace329ab11fbc38da3275b.png" height="20" width="20">
                                </div>
                            </div>
                            <div class="StyledAddToCart" style="border-top: none;">
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                    <div class="QuantityInput">
                                        <p class="label">Số Lượng</p>
                                        <div class="group-input" >
                                            <button id="decrease">
                                                <img src="https://frontend.tikicdn.com/_desktop-next/static/img/pdp_revamp_v2/icons-remove.svg" alt="remove-icon" width="20" height="20">
                                            </button>
                                            <input type="text" class="input" id="quantity" value="1">
                                            <button id="increase">
                                                <img src="https://frontend.tikicdn.com/_desktop-next/static/img/pdp_revamp_v2/icons-add.svg" alt="add-icon" width="20" height="20">
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="PriceContainerStyled">
                                    <div class="PriceLabelStyled">Tạm tính</div>
                                    <div class="PriceStyled" style="display: flex; align-items: center; gap: 8px;">
                                        @{
                                            var tmpPrice = finalPrice;
                                        }
                                        <div id="tempPrice">  @tmpPrice</div>
                                    </div>
                                </div>
                                <div class="group-button">
                                    <button class="PrimaryButtonStyled">
                                        <span>Mua ngay</span>
                                    </button>
                                    <button type="button" data-view-id="pdp_add_to_cart_button" class="SecondaryButtonStyled">Thêm vào giỏ</button>
                                    <button type="button" class="SecondaryButtonStyled">
                                        <div>Mua trước trả sau</div>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <script src="~/js/ProductPage/main-view.js"></script>
    <script src="~/js/ProductPage/Quantity.js"></script>"
    <script src="~/js/ProductPage/slider.js"></script>"
    <script>
        const finalPrice = @finalPrice;
    </script>
</main>
</html>